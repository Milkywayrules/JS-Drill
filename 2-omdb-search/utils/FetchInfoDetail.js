import { ENV } from "../_env.js";

/**
 * 
 * Fetch detailed info about movie, series, or film with the IMDB ID as an input.
 * 
 * @param {any} inputImdbID e.g. tt9430698
 * @param {any} plot "full" for long plot | "short" for very short plot
 * @returns Promise with obj {singleData:json, nCallAPI:nCallAPI}
 */
export const FetchInfoDetail = async (inputImdbID, plot = "full") => {
  let nCallAPI = 0;
  // check the search box is empty or not
  if (inputImdbID === undefined) {
    alert("Fill the search title correctly.");
    throw new Error("Fill the search title correctly.");
  }

  // fetch the movie search request
  const res = await fetch(`${ENV.fullUrl.byId}&plot${plot}&i=${inputImdbID}`);
  const json = await res.json();
  nCallAPI++;

  // if the movies didn't exist in the API then reject the Promise
  if (json.Response === "False") {
    return new Promise((resolve, reject) => {
      reject(json.Error);
    });
  }

  // if the movies didn't have a poster image
  if (json.Poster == "N/A") {
    json.Poster = "data:image/png;base64,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"
  }

  console.info("Fetching process only require 1x call.", "\nID:", inputImdbID);

  return new Promise((resolve) => {
    resolve({
      singleData: json,
      nCallAPI,
    });
  });
};
